{# Copyright 2015 The Pennsylvania State University. Office of the Vice Provost for Educational Equity. All Rights Reserved. #}
{% extends "datalocker/app_template.html" %}
{% load staticfiles %}

{% block breadcrumb-trail %}
  <li>
    <a href="{% url 'datalocker:index' %}">
      <span class="sr-only">List of </span>My Lockers
    </a>
  </li>
  <li>
    <a href="{% url 'datalocker:submissions_list' object.locker.id %}">
      All Submissions<span class="sr-only"> for {{ object.locker.name }}</span>
    </a>
  </li>
  <li class="active">
    <span class="sr-only">{{ object.locker.name }}</span> Submission
  </li>
{% endblock breadcrumb-trail %}

{% block page-meta-title %}Submission View{% endblock page-meta-title %}

{% block site-styles %}
  {{ block.super }}
  <link type="text/css" rel="stylesheet"
        href="{% static 'datalocker/css/user_colors.css' %}" />
{% endblock site-styles %}

{% block content %}
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-{% if sidebar_enabled %}8{% else %}12{% endif %}">
        <h1>{{ object.locker.name }}</h1>

        <div class="pagination" aria-label="submission navigation buttons">
          {% include "datalocker/pagination_template.html" %}
        </div>

        <ul class="submission-view">
          <li class="header">Submission Date</li>
          <li class="information">{{ object.timestamp }}</li>
          {% for key, value in object.data_dict.items %}
            <li class="header">{{ key }}</li>
            <li class="information">{{ value }}</li>
          {% endfor %}
        </ul>

        <div class="pagination" aria-label="submission navigation buttons">
          {% include "datalocker/pagination_template.html" %}
        </div>
      </div>


      {% if sidebar_enabled %}
        <div class="col-md-4">
          <div class="panel panel-default panel-workflow">
            <div class="panel-heading">
              <div class="panel-title">Workflow</div>
            </div>
            <div class="panel-body">
            </div>
          </div>

          {% if commenting_enabled %}
          <div class="panel panel-default panel-comments"
            id="comments-div">
            <div class="panel-heading">
              <div class="panel-title">Comments</div>
            </div>
            <div class="panel-body">
              <div class="comment-controls">
                <form method="POST"
                  id="comment-form"
                  action="{% url 'datalocker:add_comment' object.locker.id object.pk %}"
                  data-url="{% url 'datalocker:get_comments' object.locker.id object.pk %}">
                {% csrf_token %}
                  <textarea
                    id="comment-text"
                    name="comment"
                    placeholder="Add Comment"
                    class="comment-textarea"></textarea>
                  <button type="button"
                    id="comment-add"
                    class="btn btn-primary btn-xs comment-button"
                    role="add-comment"
                    >Add</button>
                </form>
              </div>
              <div class="comment-feed-container">
                <ul class="media-list" id="comment-list">
                </ul>
              </div>
            </div>
          </div>
          {% endif %}
        </div>
      {% endif %}
    </div>
  </div>
{% endblock %}


{% block site-scripts %}
  {{ block.super }}
  <script type="text/javascript"
          src="{% static 'datalocker/js/commenting.js' %}"></script>
{% endblock site-scripts %}